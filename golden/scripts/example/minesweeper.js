!function r(a,o,i){function s(n,e){if(!o[n]){if(!a[n]){var t="function"==typeof require&&require;if(!e&&t)return t(n,!0);if(u)return u(n,!0);throw(e=new Error("Cannot find module '"+n+"'")).code="MODULE_NOT_FOUND",e}t=o[n]={exports:{}},a[n][0].call(t.exports,function(e){return s(a[n][1][e]||e)},t,t.exports,r,a,o,i)}return o[n].exports}for(var u="function"==typeof require&&require,e=0;e<i.length;e++)s(i[e]);return s}({1:[function(e,n,t){function r(e){var n=Array.from(document.querySelectorAll('link[href*=".css"]')),t=0;function r(){t>=n.length&&e()}n.forEach(function(e){e.sheet?t++:e.addEventListener("load",function(){t++,r()}),r()})}function a(e){"complete"===document.readyState||"interactive"===document.readyState?setTimeout(e,1):document.addEventListener("DOMContentLoaded",e)}n.exports={all:function(e){var n=!1,t=!1;a(function(){n=!0,t&&e()}),r(function(){t=!0,n&&e()})},document:a,styles:r}},{}],2:[function(e,n,t){function d(e,n){return(e=>{if(Array.isArray(e))return e})(e)||((e,n)=>{var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,o,i,s=[],u=!0,d=!1;try{if(o=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;u=!1}else for(;!(u=(r=o.call(t)).done)&&(s.push(r.value),s.length!==n);u=!0);}catch(e){d=!0,a=e}finally{try{if(!u&&null!=t.return&&(i=t.return(),Object(i)!==i))return}finally{if(d)throw a}}return s}})(e,n)||((e,n)=>{var t;if(e)return"string"==typeof e?r(e,n):"Map"===(t="Object"===(t={}.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:t)||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?r(e,n):void 0})(e,n)||(()=>{throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")})()}function r(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}var e=e("../_modules/document-ready"),a=new URLSearchParams(window.location.search),c={reRender:"re-render",isPlaying:"is-playing",gameOver:"game-over"},l={},o=(Object.keys(c).forEach(function(e){l[e]=document.createEvent("Event"),l[e].initEvent(c[e],!0,!0)}),{beginner:{square:8,mineCount:10},intermediate:{square:16,mineCount:40},expert:{square:24,mineCount:99}}),i=document.querySelector("select[name=difficulty]"),s=document.querySelector("ul.table"),u=document.querySelector("button.face-button"),m={containerElement:document.querySelector(".time"),hundredsElement:document.querySelector(".time .hundreds"),tensElement:document.querySelector(".time .tens"),onesElement:document.querySelector(".time .ones"),value:0,date:void 0},v={containerElement:document.querySelector(".mine-count-down"),hundredsElement:document.querySelector(".mine-count-down .hundreds"),tensElement:document.querySelector(".mine-count-down .tens"),onesElement:document.querySelector(".mine-count-down .ones"),flagCount:0,minesMinusFlags:0},f={isPlaying:!1,gameOver:!1,hasWon:!1,minesSet:!1},y=[];function h(e,n){function t(e){e&&e.preventDefault(),o.isRevealed?(e=>g([(e=d(e,2))[0],e[1]]).filter(function(e){return e.hasFlag}).length)([i,s])===o.value&&b([i,s]):o.reveal()}function r(e){e&&e.preventDefault(),o.isRevealed||(o.hasFlag=!o.hasFlag,document.body.dispatchEvent(l.reRender))}function a(){n.removeEventListener("click",t),n.removeEventListener("contextmenu",r),n.removeEventListener("mousedown",L),n.removeEventListener("mouseup",p),n.removeEventListener("mouseout",p),document.body.removeEventListener(c.gameOver,o.updateClasses),document.body.removeEventListener(c.reRender,o.updateClasses),document.body.removeEventListener(c.isPlaying,u)}var o=this,e=d(e,2),i=e[0],s=e[1],u=(this.isMine=!1,this.hasFlag=!1,this.isRevealed=!1,this.value=0,this.row=i,this.column=s,this.updateClasses=function(){o.hasFlag?n.classList.add("flag"):n.classList.remove("flag"),o.isRevealed&&(n.classList.add("active"),n.dataset.value=o.value),f.hasWon&&o.isMine?n.classList.add("flag"):f.gameOver&&o.isMine&&n.classList.add("mine"),f.gameOver&&o.hasFlag&&!o.isMine&&n.classList.add("not-flag")},this.reveal=function(){o.isRevealed||o.hasFlag||(o.isRevealed=!0,f.isPlaying&&u())},function(){o.isRevealed&&(o.isMine&&(f.gameOver=!0,n.classList.add("red"),f.isPlaying=!1,document.body.dispatchEvent(l.gameOver)),0===o.value&&b([i,s]),document.body.dispatchEvent(l.reRender))});n.addEventListener("click",t),n.addEventListener("contextmenu",r),n.addEventListener("mousedown",L),n.addEventListener("mouseup",p),n.addEventListener("mouseout",p),document.body.addEventListener(c.gameOver,o.updateClasses),document.body.addEventListener(c.reRender,o.updateClasses),document.body.addEventListener(c.isPlaying,u),document.body.addEventListener(c.gameOver,a),this.destroy=function(){a(),document.body.removeEventListener(c.gameOver,a),n.remove()}}function g(e){for(var e=d(e,2),n=e[0],t=e[1],r=w().square,a=[],o=n-1;o<=n+1;o++)for(var i=t-1;i<=t+1;i++)o<0||i<0||r<=o||r<=i||o===n&&i===t||a.push(y[o][i]);return a}function E(){return y.reduce(function(e,n){return e.concat(n)},[])}function L(){f.hasWon||f.gameOver||u.classList.add("o")}function p(){u.classList.remove("o")}function b(e){e=d(e,2);g([e[0],e[1]]).forEach(function(e){e.reveal()})}function S(){var e=i.value.toString();(a=new URLSearchParams(window.location.search)).set("difficulty",e),history.pushState("","","?".concat(a.toString())),window.top.postMessage("difficulty=".concat(e),"*")}function w(){return o[i.value]}function M(){var e=m.hundredsElement,n=m.tensElement,t=m.onesElement,r=m.value;e.dataset.number=Math.floor(r/100),n.dataset.number=Math.floor(r/10%10),t.dataset.number=r%10}function q(){for(var e=w(),n=e.mineCount,t=e.square,r=n;r;){var a=Math.floor(Math.random()*t),o=Math.floor(Math.random()*t);y[a][o].isRevealed||y[a][o].isMine||(y[a][o].isMine=!0,r--)}E().forEach(function(e){e.value=(e=>g([(e=d(e,2))[0],e[1]]).filter(function(e){return e.isMine}).length)([e.row,e.column]),e.updateClasses()}),f.minesSet=!0,f.isPlaying=!0,m.date=Date.now(),document.body.dispatchEvent(l.isPlaying)}function O(){var e=w().mineCount;E().filter(function(e){return!e.isRevealed}).length===e&&(f.hasWon=!0,f.isPlaying=!1,document.body.dispatchEvent(l.gameOver))}function C(){var e=v.hundredsElement,n=v.tensElement,t=v.onesElement,r=v.minesMinusFlags;e.dataset.number=Math.floor(r/100),n.dataset.number=Math.floor(r/10%10),t.dataset.number=r%10}function R(){function t(e,n){return e+(n.hasFlag?1:0)}var e=w().mineCount;v.flagCount=y.reduce(function(e,n){return e+n.reduce(t,0)},0),v.minesMinusFlags=e-v.flagCount,C()}function P(){f.isPlaying&&(1e3<Date.now()-m.date&&(m.value++,M(),m.date=Date.now()),setTimeout(P,200))}function F(){f.hasWon?(u.classList.add("sunglasses"),v.minesMinusFlags=0,C()):u.classList.add("dead")}function A(){for(var e=0;e<y.length;e++)for(var n=0;n<y[e].length;n++)y[e][n].destroy(),y[e][n]=void 0;y=[],m.value=0,m.date=void 0,v.flagCount=0,v.minesMinusFlags=0,f.hasWon=!1,f.gameOver=!1,f.isPlaying=!1,f.minesSet=!1,u.classList.remove("sunglasses"),u.classList.remove("dead");var t=w().square;s.innerHTML="";for(var r=0;r<t;r++){y.push(new Array(t));for(var a=0;a<t;a++){var o=document.createElement("li");o.classList.add("".concat(r,"-").concat(a)),o.classList.add("mine-sweeper-tile"),o.innerHTML="".concat(r,"-").concat(a),y[r][a]=new h([r,a],o),s.appendChild(o)}}document.querySelectorAll("[data-difficulty]").forEach(function(e){e.dataset.difficulty=i.value}),M(),C()}e.document(function(){document.body.addEventListener(c.gameOver,F),document.body.addEventListener(c.reRender,R),document.body.addEventListener(c.reRender,O),document.body.addEventListener(c.isPlaying,P),a.has("difficulty")&&(document.querySelector("select[name=difficulty]").value=a.get("difficulty")),i.addEventListener("change",function(){S(),A()}),u.addEventListener("click",A),u.addEventListener("mousedown",L),u.addEventListener("mouseup",p),u.addEventListener("mouseout",p),s.addEventListener("click",function(){f.isPlaying||f.hasWon||f.gameOver||q()}),S(),A()})},{"../_modules/document-ready":1}]},{},[2]);